"use strict";Vue.component("star",{template:"#m_star",data:function(){return{stars_num:5,stars_msg:["非常差","很差","一般","很好","非常好"],stars_chosen_msg:"",stars_chosen:0}},mounted:function(){},methods:{c_star:function(e){var t=this;t.stars_chosen=e+1,t.stars_chosen_msg=t.stars_msg[t.stars_chosen-1]}}}),Vue.component("m-textarea",{template:"#m_textarea",data:function(){return{content:""}},mounted:function(){},methods:{}}),Vue.component("upload",{template:"#m_upload",data:function(){return{uploadItem:[],subUpload:[],maxNum:5}},mounted:function(){},methods:{delImg:function(e){var t=this;t.uploadItem.splice(e,1),t.subUpload.splice(e,1)},fileChange:function(e){var t=this,o={};o=void 0===e.target?e[0]:e.target.files[0];var s=new FormData;s.append("action","head"),s.append("file",o),jAjax({type:"post",url:config.uploadFileUrl,data:s,contentType:!1,timeOut:6e4,success:function(e){e&&(e=JSON.parse(e),200==parseInt(e.code)&&(t.uploadItem.push(e.data.fullUrl),t.subUpload.push(e.data.url)))}})}}});var app=new Vue({mounted:function(){},data:{showAlert:!1,msg:null,order_detail:config.order_detail,anonymous:!1,is_break:!1},watch:{},methods:{sub:function(){var e=this,t=[];e.order_detail.orderGoods.forEach(function(o,s){var n=e.$refs.star[s],a=e.$refs.text[s],r=e.$refs.uploadimg[s],u={};u.goodsId=o.goodsId,u.content=a.content,u.descScore=n.stars_chosen,u.picture=r.subUpload,t.push(u)}),e.is_break||jAjax({type:"post",url:config.commentUrl,data:{order_id:e.order_detail.orderId,express_score:e.$refs.express.stars_chosen,sale_score:e.$refs.sale.stars_chosen,has_anonymous:e.anonymous,products:JSON.stringify(t)},timeOut:5e3,before:function(){console.log("before")},success:function(t){t&&(t=JSON.parse(t),parseInt(t.code),e.msg=t.message,e.showAlert=!0,e.close_auto())},error:function(e,t){console.log(t)}})},close:function(){this.showAlert=!1},close_auto:function(e,t){var o=this;setTimeout(function(){o.showAlert=!1,e&&e(t)},1500)},linkto:function(e){e&&(location.href=e)}}}).$mount("#ordercomment");