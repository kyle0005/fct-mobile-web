"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function base64_encode(e){var t=0,i=[],n=0,s=0;if(e.length>0)for(;s<e.length;){var a=e.charCodeAt(s++);switch(++t){case 1:i.push(tab[a>>2]),n=3&a,s>=e.length&&(i.push(tab[n<<4]),i.push("=="));break;case 2:i.push(tab[a>>4|n<<4]),n=15&a,s>=e.length&&(i.push(tab[n<<2]),i.push("="));break;case 3:i.push(tab[a>>6|n<<2]),i.push(tab[63&a]),n=0,t=0}}return i.join("")}function EventTarget(){this.handlers={}}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),tools={animate:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ease-out",s=arguments[4];clearInterval(e.timer),i instanceof Function?(s=i,i=400):i instanceof String&&(n=i,i=400),n instanceof Function&&(s=n,n="ease-out");var a=function(t){return"opacity"===t?Math.round(100*tools.getStyle(e,t,"float")):tools.getStyle(e,t)},o=parseFloat(document.documentElement.style.fontSize),r={},c={};Object.keys(t).forEach(function(e){/[^\d^\.]+/gi.test(t[e])?r[e]=t[e].match(/[^\d^\.]+/gi)[0]||"px":r[e]="px",c[e]=a(e)}),Object.keys(t).forEach(function(e){"rem"==r[e]?t[e]=Math.ceil(parseInt(t[e])*o):t[e]=parseInt(t[e])});var l=!0,h={};e.timer=setInterval(function(){Object.keys(t).forEach(function(o){var r,d=0,u=!1,m=a(o)||0,g=0;switch(n){case"ease-out":g=m,r=5*i/400;break;case"linear":g=c[o],r=20*i/400;break;case"ease-in":d=(h[o]||0)+(t[o]-c[o])/i,h[o]=d;break;default:g=m,r=5*i/400}switch("ease-in"!==n&&(d=(t[o]-g)/r,d=d>0?Math.ceil(d):Math.floor(d)),n){case"ease-out":u=m!=t[o];break;case"linear":case"ease-in":u=Math.abs(Math.abs(m)-Math.abs(t[o]))>Math.abs(d);break;default:u=m!=t[o]}u?(l=!1,"opacity"===o?(e.style.filter="alpha(opacity:"+(m+d)+")",e.style.opacity=(m+d)/100):"scrollTop"===o?(e.documentElement.scrollTop=m+d,e.body.scrollTop=m+d):e.style[o]=m+d+"px"):l=!0,l&&(clearInterval(e.timer),s&&s())})},20)},showBack:function(e){var t,i;document.addEventListener("scroll",function(){s()},!1),document.addEventListener("touchstart",function(){s()},{passive:!0}),document.addEventListener("touchmove",function(){s()},{passive:!0}),document.addEventListener("touchend",function(){i=document.body.scrollTop,n()},{passive:!0});var n=function e(){t=requestAnimationFrame(function(){document.body.scrollTop!=i?(i=document.body.scrollTop,e()):cancelAnimationFrame(t),s()})},s=function(){e(document.body.scrollTop>500?!0:!1)}},loadMore:function(e,t){var i,n,s,a,o,r,c=window.screen.height;document.body.addEventListener("scroll",function(){h()},!1),e.addEventListener("touchstart",function(){i=e.offsetHeight,n=e.offsetTop,s=tools.getStyle(e,"paddingBottom"),a=tools.getStyle(e,"marginBottom")},{passive:!0}),e.addEventListener("touchmove",function(){h()},{passive:!0}),e.addEventListener("touchend",function(){r=document.body.scrollTop,l()},{passive:!0});var l=function t(){o=requestAnimationFrame(function(){document.body.scrollTop!=r?(r=document.body.scrollTop,h(),t()):(cancelAnimationFrame(o),i=e.offsetHeight,h())})},h=function(){document.body.scrollTop+c>=i+n+s+a&&t()}},getStyle:function(e,t){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"int";return i="scrollTop"===t?e.documentElement.scrollTop||e.body.scrollTop:e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null)[t],"float"==n?parseFloat(i):parseInt(i)},getUrlKey:function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.href)||[,""])[1].replace(/\+/g,"%20"))||null},ajaxGet:function(e,t,i,n){jAjax({type:"get",url:e,timeOut:5e3,before:function(){i&&i()},success:function(e){e&&(e=JSON.parse(e),200==parseInt(e.code)&&t?t(e):console.log("false"))},error:function(){n&&n()}})},ajaxPost:function(e,t,i,n,s,a,o,r){var c=5e3;r||(c=6e4),jAjax({type:"post",url:e,data:t||{},timeOut:c,contentType:r,before:function(){n&&n()},success:function(e){e&&(e=JSON.parse(e),200==parseInt(e.code)&&i&&i(e,a),e.message&&null!==e.message&&""!==e.message&&o&&o(e),e.url&&(location.href=e.url))},error:function(e,t){s&&s()}})},getScrollTop:function(){var e=0,t=0;return document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),e-t>0?e:t},getScrollHeight:function(){var e=0,t=0;return document.body&&(e=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),e-t>0?e:t},getWindowHeight:function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},imgCompress:function(e,t){var i=document.createElement("canvas"),n=i.getContext("2d"),s=new Image;if(window.FileReader){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){s.src=e.target.result}}s.onload=function(){var a=this.width,o=this.height,r=a,c=o;(a>750||o>750)&&(a/o>1?(r=750,c=Math.round(o/a*750)):(c=750,r=Math.round(a/o*750))),i.width=r,i.height=c,n.clearRect(0,0,r,c),n.drawImage(s,0,0,r,c),i.toBlob(function(i){t&&t(i,e.name)},e.type||"image/png",.9)}}};EventTarget.prototype={constructor:EventTarget,addEvent:function(e,t){void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t)},fireEvent:function(e){if(e.target||(e.target=this),this.handlers[e.type]instanceof Array)for(var t=this.handlers[e.type],i=0;i<t.length;i++)t[i](e)},removeEvent:function(e,t){if(this.handlers[e]instanceof Array){for(var i=this.handlers[e],n=0;n<i.length&&i[n]!=t;n++);i.splice(n,1)}}};var def_target=new EventTarget,_util={debounce:function(e,t){var i=this,n=arguments,s=void 0;return function(){clearTimeout(s),s=setTimeout(function(){e.apply(i,n)},t)}},getPicInfo:function(e){var t=e.src||"",i=e.fastCallback,n=e.loadedCallback,s=e.errorCallback,a=new Image,o={isError:!1,width:0,height:0},r=function(){(o.isError||a.width>0||a.height>0)&&(clearInterval(c),o.width=a.width,o.height=a.height,i&&i(o))},c=void 0;a.src=t,a.addEventListener("error",function(e){o.isError=!0,s&&s(o)},!1),a.complete?(o.width=a.width,o.height=a.height,i&&i(o),n&&n(o)):(a.addEventListener("load",function(){o.width=a.width,o.height=a.height,n&&n(o)},!1),c=setInterval(r,50))}},VueViewload=function(){function e(t){_classCallCheck(this,e),this.emptyPic="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.defaultPic=t&&t.defaultPic||this.emptyPic,this.errorPic=t&&t.errorPic||this.emptyPic,this.container=t&&t.container||window,this.threshold=t&&parseInt(t.threshold,10)||0,this.effectFadeIn=t&&t.effectFadeIn||!1,this.callback=t&&t.callback||new Function,this.selector=t&&t.selector||[],this.event=["scroll","resize"],this.status=["loading","loaded","error"],this.delayRender=_util.debounce(this.render.bind(this),200)}return _createClass(e,[{key:"inView",value:function(e){var t=!1,i=e.getBoundingClientRect(),n=this.container==window?{left:0,top:0}:this.container.getBoundingClientRect(),s=this.container==window?window.innerWidth:this.container.clientWidth,a=this.container==window?window.innerHeight:this.container.clientHeight;return i.bottom>this.threshold+n.top&&i.top+this.threshold<a+n.top&&i.right>this.threshold+n.left&&i.left+this.threshold<s+n.left&&(t=!0),t}},{key:"bindUI",value:function(){var e=this;this.event.forEach(function(t,i){e.container.addEventListener(t,e.delayRender,!1),e.container!==window&&"resize"==t&&window.addEventListener(t,e.delayRender,!1)}),def_target.addEvent("slide",this.delayRender)}},{key:"unbindUI",value:function(){var e=this;this.event.forEach(function(t,i){e.container.removeEventListener(t,e.delayRender,!1),e.container!==window&&"resize"==t&&window.removeEventListener(t,e.delayRender,!1)}),def_target.removeEvent("slide",this.delayRender)}},{key:"render",value:function(){var e=this;this.isLoadEvent||(this.isLoadEvent=!0,this.bindUI()),this.selector.length||this.unbindUI();for(var t=0;t<this.selector.length;t++){(function(i){var n=e.selector[i],s=n.ele.nodeName.toLowerCase();if("none"==getComputedStyle(n.ele,null).display)return e.selector.splice(i--,1),"continue";"img"==s&&(n.ele.getAttribute("data-src")||(n.ele.setAttribute("data-src",n.src),n.ele.setAttribute("data-status",e.status[0])),n.ele.getAttribute("src")||n.ele.setAttribute("src",e.defaultPic)),e.inView(n.ele)&&("img"==s?(_util.getPicInfo({src:n.src,errorCallback:function(t){n.ele.src=e.errorPic,n.ele.setAttribute("data-status",e.status[2])},loadedCallback:function(t){e.effectFadeIn&&(n.ele.style.opacity=0),n.ele.src=t.isError?e.errorPic:n.src,n.ele.removeAttribute("data-src"),n.ele.setAttribute("data-status",e.status[1]),setTimeout(function(){n.ele.style.opacity=1,n.ele.style.transition="all 1s"},50)}}),e.callback(n.ele,n.src)):"function"==typeof n.src&&n.src.call(n.ele),e.selector.splice(i--,1)),t=i})(t)}}}]),e}();Vue.directive("view",{inserted:function(e,t){var i={},n={threshold:-50},s=void 0,a=void 0==t.arg?"window":t.arg;void 0==i[a]&&(i[a]=[]),i[a].push({ele:e,src:t.value}),Vue.nextTick(function(){void 0===s&&(s=_util.debounce(function(){for(var e in i)n.container="window"==e?window:document.getElementById(e),n.selector=i[e],new VueViewload(n).render()},200)),s()})},bind:function(e,t){var i={},n={threshold:-50},s=void 0,a=void 0==t.arg?"window":t.arg;void 0==i[a]&&(i[a]=[]),i[a].push({ele:e,src:t.value}),Vue.nextTick(function(){void 0===s&&(s=_util.debounce(function(){for(var e in i)n.container="window"==e?window:document.getElementById(e),n.selector=i[e],new VueViewload(n).render()},200)),s()})},update:function(e,t){var i={},n={threshold:-50},s=void 0,a=void 0==t.arg?"window":t.arg;void 0==i[a]&&(i[a]=[]),i[a].push({ele:e,src:t.value}),Vue.nextTick(function(){void 0===s&&(s=_util.debounce(function(){for(var e in i)n.container="window"==e?window:document.getElementById(e),n.selector=i[e],new VueViewload(n).render()},200)),s()})},componentUpdated:function(e,t){var i={},n={threshold:-50},s=void 0,a=void 0==t.arg?"window":t.arg;void 0==i[a]&&(i[a]=[]),i[a].push({ele:e,src:t.value}),Vue.nextTick(function(){void 0===s&&(s=_util.debounce(function(){for(var e in i)n.container="window"==e?window:document.getElementById(e),n.selector=i[e],new VueViewload(n).render()},200)),s()})}}),Vue.directive("load-more",{bind:function(e,t){var i=(window.screen.height,void 0),n=void 0,s=void 0,a=void 0,o=void 0,r=void 0,c=void 0,l=void 0,h=e.attributes.type&&e.attributes.type.value;2==h?(c=e,l=e.children[0]):(c=document.body,l=e),e.addEventListener("touchstart",function(){i=l.clientHeight,2==h&&(i=i),n=e.offsetTop,s=tools.getStyle(e,"paddingBottom"),a=tools.getStyle(e,"marginBottom")},!1),e.addEventListener("touchmove",function(){},!1),e.addEventListener("touchend",function(){r=c.scrollTop},!1),window.addEventListener("scroll",function(){parseFloat(tools.getScrollTop())+parseFloat(tools.getWindowHeight())==parseFloat(tools.getScrollHeight())&&d()});var d=function e(){o=requestAnimationFrame(function(){c.scrollTop!=r?(r=c.scrollTop,e()):(cancelAnimationFrame(o),i=l.clientHeight,u())})},u=function(){t.value()}}});var photo_html='<div class="photogallery-container"><transition appear name="v-img-fade"><div v-if="!closed" class="fullscreen-v-img" @click.self="close()"><div class="header-v-img"><span v-if="images.length > 1" class="count-v-img">{{ currentImageIndex + 1 }}/{{ images.length }}</span><span class="close-v-img" @click="close">&times;</span></div><transition appear name="v-img-fade"><span v-if="visibleUI && images.length !== 1" class="prev-v-img" @click="prev"><svg width="25" height="25" viewBox="0 0 1792 1915" xmlns="http://www.w3.org/2000/svg"><path d="M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z" fill="#fff"/></svg></span></transition><transition appear name="v-img-fade"><span v-if="visibleUI && images.length !== 1" class="next-v-img" @click="next"><svg width="25" height="25" viewBox="0 0 1792 1915" xmlns="http://www.w3.org/2000/svg"><path d="M1600 960q0 54-37 91l-651 651q-39 37-91 37-51 0-90-37l-75-75q-38-38-38-91t38-91l293-293h-704q-52 0-84.5-37.5t-32.5-90.5v-128q0-53 32.5-90.5t84.5-37.5h704l-293-294q-38-36-38-90t38-90l75-75q38-38 90-38 53 0 91 38l651 651q37 35 37 90z" fill="#fff"/></svg></span></transition><div class="content-v-img"><img :src="images[currentImageIndex]" id="img-slide"></div></div></transition></div>',imgscreen=Vue.extend({template:photo_html,data:function(){return{images:[],visibleUI:!0,currentImageIndex:0,closed:!0,uiTimeout:null}},methods:{close:function(){document.querySelector("body").classList.remove("body-fs-v-img"),this.images=[],this.currentImageIndex=0,this.closed=!0},next:function(){this.currentImageIndex+1<this.images.length?this.currentImageIndex++:this.currentImageIndex=0},prev:function(){this.currentImageIndex>0?this.currentImageIndex--:this.currentImageIndex=this.images.length-1},showUI:function(){var e=this;clearTimeout(this.uiTimeout),this.visibleUI=!0,this.uiTimeout=setTimeout(function(){e.visibleUI=!1},3500)}},created:function(){var e=this,t=this;window.addEventListener("scroll",function(){e.close()}),window.addEventListener("mousemove",function(){e.showUI()});var i=document.querySelector("body"),n=new Hammer(i);n.on("swipeleft",function(e){t.next()}),n.on("swiperight",function(e){t.prev()})}});Vue.directive("img",{bind:function(e,t){var i="pointer",n="",s=t.arg||null;void 0!==t.value&&(i=t.value.cursor||i,n=t.value.exsrc,s=t.value.group||s),e.setAttribute("data-vue-img-group",s||null),t.value&&t.value.exsrc&&e.setAttribute("data-vue-img-src",t.value.exsrc),n||console.error("v-img element missing src parameter."),e.style.cursor=i;var a=document.vueImg;if(!a){var o=document.createElement("div");o.setAttribute("id","imageScreen"),document.querySelector("body").appendChild(o),a=document.vueImg=(new imgscreen).$mount("#imageScreen")}e.addEventListener("click",function(){document.querySelector("body").classList.add("body-fs-v-img");var t=[].concat(_toConsumableArray(document.querySelectorAll('img[data-vue-img-group="'+s+'"]')));0==t.length?Vue.set(a,"images",[n]):(Vue.set(a,"images",t.map(function(e,t,i){return e.dataset.vueImgSrc||e.src})),Vue.set(a,"currentImageIndex",t.indexOf(e))),Vue.set(a,"closed",!1)})}});var pop_html='<div class="alet_container"><section class="tip_text_container"><div class="tip_text">{{ msg }}</div></section></div>';Vue.component("pop",{template:pop_html,data:function(){return{positionY:0,timer:null}},props:["msg"],methods:{close:function(){this.$emit("close")}}});var confirm_html='<div class="confirm-container"><div class="inner"><div class="confirm-con"><div class="confirm-title" v-if="title">{{ title }}</div><div class="confirm-text" v-if="msg">{{ msg }}</div></div><div class="confirm-btn"><a href="javascript:;" class="cancel" @click="no()">{{ notxt }}</a><a href="javascript:;" class="ok" @click="ok()">{{ oktxt }}</a></div></div></div>';Vue.component("confirm",{template:confirm_html,data:function(){return{positionY:0,timer:null}},props:{title:{type:String,default:"您确认要执行此操作？"},msg:{type:String,default:""},callback:{type:Function,default:null},obj:{type:Object,default:null},notxt:{type:String,default:"取消"},oktxt:{type:String,default:"确认"}},methods:{no:function(){this.$emit("no")},ok:function(){this.$emit("ok",this.callback,this.obj)}}});var post_html='<span id="post" class="post-container"><span class="post-inner" v-if="postProcess">{{ txt }}<span v-if="status">...</span></span><span class="post-inner" @click="sub()" v-else>{{ txt }}</span></span>';Vue.component("subpost",{template:post_html,props:{txt:{type:String,default:""},status:{type:Boolean,default:!1}},data:function(){return{postProcess:!1}},mounted:function(){},methods:{sub:function(){this.$emit("callback")},post:function(e,t,i){var n=this;n.postProcess=!0,i&&i.delaynum?setTimeout(function(){tools.ajaxPost(e,t,n.success,n.before,n.error,i,n.alert)},i.delaynum):tools.ajaxPost(e,t,n.success,n.before,n.error,i,n.alert)},before:function(){this.$emit("before")},success:function(e,t){var i=this;i.postProcess=!1,i.$emit("success",e,t)},error:function(){var e=this;e.$emit("error"),e.postProcess=!1},alert:function(e){var t=this;t.$emit("alert",e),setTimeout(function(){t.postProcess=!1},1500)}}});var nodata_html='<div class="noData"><div class="inner"><img :src="imgurl"><span class="no">{{ text }}</span></div></div>';Vue.component("no-data",{template:nodata_html,data:function(){return{}},props:{imgurl:{type:String,default:""},text:{type:String,default:""}},mounted:function(){},methods:{}}),function(e,t){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=e.document?t(e):function(e){if(!e.document)throw new Error("previewImage requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:void 0,function(e){var t={};t.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},t.all=function(e,t){var i,n=[];return i=t?t.querySelectorAll(e):document.querySelectorAll(e),i&&i.length>0&&(n=Array.prototype.slice.call(i)),n},t.delegate=function(e,i,n,s){e&&e.addEventListener(i,function(i){var a=t.all(n,e);if(a)for(var o=0;o<a.length;o++)for(var r=i.target;r;){if(r==a[o]){s.call(r,i);break}if((r=r.parentNode)==e)break}},!1)};var i=function(){this.winw=e.innerWidth||document.body.clientWidth,this.winh=e.innerHeight||document.body.clientHeight,this.originWinw=this.winw,this.originWinh=this.winh,this.marginRight=15,this.imageChageMoveX=this.marginRight+this.winw,this.imageChageNeedX=Math.floor(.5*this.winw),this.cssprefix=["","webkit","Moz","ms","o"],this.version="1.0.3",this.imgLoadCache=new Object,this.scale=1,this.maxScale=4,this.maxOverScale=6,this.openTime=.3,this.slipTime=.5,this.maxOverWidthPercent=.5,this.$box=!1,this.isPreview=!1;var t=document.createElement("style");t.innerText="#__previewImage-container{-ms-touch-action:none;touch-action:none;-webkit-touch-action:none;line-height:100vh;background-color:#000;width:100vw;height:100vh;position:fixed;overflow:hidden;top:0;left:0;z-index: 2147483647;transition:transform .3s;-ms-transition:transform .3s;-moz-transition:transform .3s;-webkit-transition:transform .3s;-o-transition:transform .3s;transform:translate3d(100%,0,0);-webkit-transform:translate3d(100%,0,0);-ms-transform:translate3d(100%,0,0);-o-transform:translate3d(100%,0,0);-moz-transform:translate3d(100%,0,0)}#__previewImage-container .previewImage-text{position:absolute;top:.6em;text-align:center;font-size:18px;line-height:25px;color:#fff;z-index:10;padding: 0.2em 0.4em;background-color: rgba(255,255,255,0.4);border-radius: 50%;letter-spacing: 0;right:.8em}#__previewImage-container .previewImage-text .previewImage-text-index{font-size: 24px;}#__previewImage-container .previewImage-box{width:999999rem;height:100vh}#__previewImage-container .previewImage-box .previewImage-item{width:100vw;height:100vh;margin-right:15px;float:left;text-align:center;background:url(http://static.luyanghui.com/svg/oval.svg) no-repeat center/auto}#__previewImage-container .previewImage-box .previewImage-item.previewImage-nobackground{background:none}#__previewImage-container .previewImage-box .previewImage-item .previewImage-image{vertical-align:middle;width:100%}",t.type="text/css",this.$container=document.createElement("div"),this.$container.id="__previewImage-container",this.$container.style.width=this.winw+"px",this.$container.style.height=this.winh+"px",document.body.appendChild(this.$container),document.head.appendChild(t),this.bind()};return i.prototype.start=function(e){var i=e.urls,n=e.current;if(this.$container.innerHTML="",!i||!t.isArray(i)||0==i.length)throw new Error("urls must be a Array and the minimum length more than zero");if(n){var s=i.indexOf(n);s<0&&(s=0,console.warn("current isnot on urls,it will be the first value of urls!")),this.index=s}else this.index=0,console.warn("current is empty,it will be the first value of urls!");this.urls=i,this.maxLen=i.length-1,this.cIndex=this.maxLen+1,this.bIndex=this.maxLen+2,this.imgStatusCache=new Object,this.render()},i.prototype.render=function(){var t=this;if(!1===this.$box){var i=document.createElement("div");i.className+="previewImage-box",this.$box=i}else this.$box.innerHTML="";var n=document.createElement("div");this.$text=n,this.$text.className+="previewImage-text",this.$text.innerHTML='<span class="previewImage-text-index">'+(this.index+1)+"/</span>"+(this.maxLen+1),this.container=this.imgStatusCache[this.cIndex]={elem:this.$container,x:this.winw,y:0,m:0,my:0,scale:1,scalem:1},this.box=this.imgStatusCache[this.bIndex]={elem:this.$box,x:0,y:0,m:0,my:0,scale:1,scalem:1},this.urls.forEach(function(i,n){var s,a=document.createElement("div"),o=e.md5?md5(i+n):i+n,r=t.imgLoadCache[o];r&&r.isload?(s=r.elem,a.className+=" previewImage-nobackground"):(s=new Image,s.className+="previewImage-image",t.imgLoadCache[o]={isload:!1,elem:s},n==t.index&&(s.src=i,s.onload=function(){a.className+=" previewImage-nobackground",t.imgLoadCache[o].isload=!0})),t.imgStatusCache[n]={hash:o,x:0,m:0,y:0,my:0,scale:t.scale,scalem:1},a.className+=" previewImage-item",a.appendChild(s),t.$box.appendChild(a)}),this.$container.appendChild(this.$box),this.$container.appendChild(this.$text);var s=-this.imageChageMoveX*this.index;this.box.x=s,this.container.x=0,this.$container.style.display="block",setTimeout(function(){t.translateScale(t.bIndex,0),t.translateScale(t.cIndex,t.openTime),t.isPreview=!0},50)},i.prototype.bind=function(){var i=this.$container,n=this,s=function(){n.closePreview.call(n)},a=function(){n.touchStartFun.call(n)},o=function(){n.touchMoveFun.call(n)},r=function(){n.touchEndFun.call(n)},c=function(){var t=this;t.winw=e.innerWidth||document.body.clientWidth,t.winh=e.innerHeight||document.body.clientHeight,t.originWinw=t.winw,t.originWinh=t.winh,t.$container.style.width=t.winw+"px",t.$container.style.height=t.winh+"px",t.imageChageMoveX=t.marginRight+t.winw;var i=-t.imageChageMoveX*t.index;try{t.box.x=i,t.translateScale(t.bIndex,0)}catch(e){}}.bind(this);e.addEventListener("resize",c,!1),t.delegate(i,"click",".previewImage-item",s),t.delegate(i,"touchstart",".previewImage-item",a),t.delegate(i,"touchmove",".previewImage-item",o),t.delegate(i,"touchend",".previewImage-item",r),t.delegate(i,"touchcancel",".previewImage-item",r)},i.prototype.closePreview=function(){var e=this;this.imgStatusCache[this.cIndex].x=this.winw,this.translateScale(this.cIndex,this.openTime),this.imgStatusRewrite(),this.translateScale(this.index,this.slipTime),setTimeout(function(){e.$container.style.display="none"},1e3*this.slipTime),e.isPreview=!1},i.prototype.touchStartFun=function(e){this.ts=this.getTouches(),this.allowMove=!0,this.statusX=0,this.statusY=0},i.prototype.touchMoveFun=function(e){this.tm=this.getTouches();var t=this.tm,i=this.ts;this.moveAction(i,t)},i.prototype.touchEndFun=function(e){this.$container;this.te=this.getTouches(),this.endAction(this.ts,this.te)},i.prototype.moveAction=function(e,t){if(this.allowMove){var i=this.getIndexImage(),n=.3*this.winw/i.scale,s=t.x0-e.x0,a=t.y0-e.y0;Math.abs(a)>0&&event.preventDefault();var o=i.x+s,r=i.y+a,c=this.getAllow(this.index),l=this.allowX=c.x;this.allowY=c.y0;if(s<=0&&(this.allowX=-l),a<=0&&(this.allowY=c.y1),1==t.length)if(i.scale>1){if(r>=c.y0){this.statusY=1;var h=r-c.y0;i.my=c.y0-i.y+this.getSlowlyNum(h,n)}else if(r<=c.y1){this.statusY=1;var h=r-c.y1;i.my=c.y1-i.y+this.getSlowlyNum(h,n)}else this.statusY=2,i.my=a;if(s<0&&i.x<=-l)this.statusX=1,this.box.m=s,this.index==this.maxLen&&(this.box.m=this.getSlowlyNum(s)),this.translateScale(this.bIndex,0),this.translateScale(this.index,0);else if(s>0&&i.x>=l)this.statusX=2,this.box.m=s,0==this.index&&(this.box.m=this.getSlowlyNum(s)),this.translateScale(this.bIndex,0),this.translateScale(this.index,0);else{if(0==s)return;if(this.statusX=3,i.m=s,o>=l){this.statusX=4;var d=o-l;i.m=l-i.x+this.getSlowlyNum(d,n)}if(o<=-l){this.statusX=4;var d=o+l;i.m=-l-i.x+this.getSlowlyNum(d,n)}this.translateScale(this.index,0)}}else if(Math.abs(a)>5&&5!=this.statusX){var u=this.getJqElem(this.index),m=u.height-this.winh;if(a>0&&r>0)this.statusX=7,this.allowY=0,i.my=-i.y+this.getSlowlyNum(r,n);else if(a<0&&r<-m)if(this.statusX=7,u.height>this.winh){var h=r+m;this.allowY=-m,i.my=-m-i.y+this.getSlowlyNum(h,n)}else this.allowY=0,i.my=-i.y+this.getSlowlyNum(r,n);else this.statusX=6,i.my=a;this.translateScale(this.index,0)}else{if(6==this.statusX)return;this.statusX=5,0==this.index&&s>0||this.index==this.maxLen&&s<0?this.box.m=this.getSlowlyNum(s):this.box.m=s,this.translateScale(this.bIndex,0)}else{var g=this.getScale(e,t),v=g*i.scale;if(v>=this.maxScale){var f=v-this.maxScale;v=this.maxScale+this.getSlowlyNum(f,this.maxOverScale),g=v/i.scale}i.scalem=g,this.translateScale(this.index,0)}}},i.prototype.endAction=function(e,t){var i=this.getIndexImage(),n=t.x0-e.x0,s=(t.y0,e.y0,t.time-e.time),a=0;if(this.allowMove=!1,1==e.length){switch(Math.abs(n)>10&&event.preventDefault(),this.statusY){case 1:i.y=this.allowY,i.my=0,a=this.slipTime;break;case 2:i.y=i.y+i.my,i.my=0}switch(this.statusX){case 1:this.index!=this.maxLen&&(n<=-this.imageChageNeedX||s<200&&n<-30)?this.changeIndex(1):(this.changeIndex(0),0!=a&&this.translateScale(this.index,a));break;case 2:0!=this.index&&(n>=this.imageChageNeedX||s<200&&n>30)?this.changeIndex(-1):(this.changeIndex(0),0!=a&&this.translateScale(this.index,a));break;case 3:i.x=i.x+i.m,i.m=0,this.translateScale(this.index,a);break;case 4:i.x=this.allowX,i.m=0,a=this.slipTime,this.translateScale(this.index,a);break;case 5:n>=this.imageChageNeedX||s<200&&n>30?this.changeIndex(-1):n<=-this.imageChageNeedX||s<200&&n<-30?this.changeIndex(1):this.changeIndex(0);break;case 6:i.y=i.y+i.my,i.my=0;break;case 7:i.y=this.allowY,i.my=0,this.translateScale(this.index,this.slipTime)}}else{event.preventDefault();var o=i.scale*i.scalem,r=this.getJqElem(this.index);i.scale=o;var c=this.getAllow(this.index);i.x>c.x?(a=this.slipTime,i.x=c.x):i.x<-c.x&&(a=this.slipTime,i.x=-c.x),i.y>c.y0?(a=this.slipTime,i.y=c.y0):i.y<c.y1&&(a=this.slipTime,i.y=c.y1),r.height*i.scale<=this.winh&&(i.y=0),r.width*i.scale<=this.winw&&(i.x=0),i.scalem=1,o>this.maxScale?(i.scale=this.maxScale,a=this.slipTime):o<1&&(this.imgStatusRewrite(),a=this.slipTime),0!=a&&(this.changeIndex(0),this.translateScale(this.index,a))}},i.prototype.getAllow=function(e){var t,i,n=this.getJqElem(e),s=this.getIndexImage(e),a=Math.floor((n.width*s.scale-this.winw)/(2*s.scale));return n.height*s.scale<=this.winh?(t=0,i=0):n.height<=this.winh?(t=Math.floor((n.height*s.scale-this.winh)/(2*s.scale)),i=-t):(t=Math.floor(n.height*(s.scale-1)/(2*s.scale)),i=-Math.floor((n.height*(s.scale+1)-2*this.winh)/(2*s.scale))),{x:a,y0:t,y1:i}},i.prototype.getSlowlyNum=function(e,t){var t=t||this.winw*this.maxOverWidthPercent;return e<0?-(1-(e=-e)/(t+e))*e:(1-e/(t+e))*e},i.prototype.getScale=function(e,t){var i=Math.sqrt(Math.pow(e.x1-e.x0,2)+Math.pow(e.y1-e.y0,2));return Math.sqrt(Math.pow(t.x1-t.x0,2)+Math.pow(t.y1-t.y0,2))/i},i.prototype.imgStatusRewrite=function(e){var e=void 0===e?this.index:e,t=this.imgStatusCache[e];t.x=0,t.y=0,t.m=0,t.my=0,t.scale=1,t.scalem=1,e!=this.index&&this.translateScale(e,this.slipTime)},i.prototype.changeIndex=function(e){var t=(this.getIndexImage(),this.index);if(0==this.index&&-1==e)this.index=this.index;else if(this.index==this.maxLen&&1==e)this.index=this.index;else{this.index+=e,this.$text.innerHTML='<span class="previewImage-text-index">'+(this.index+1)+"/</span>"+(this.maxLen+1);var i=this.imgStatusCache[this.index].hash,n=this.imgLoadCache[i];n.isload?n.elem.parentNode.className+=" previewImage-nobackground":(n.elem.src=this.urls[this.index],n.elem.onload=function(){n.elem.parentNode.className+=" previewImage-nobackground",n.isload=!0})}this.box.x=-this.imageChageMoveX*this.index,this.box.m=0,t!=this.index&&this.imgStatusRewrite(t),this.translateScale(this.bIndex,this.slipTime)},i.prototype.getIndexImage=function(e){var e=void 0==e?this.index:e;return this.imgStatusCache[this.index]},i.prototype.translateScale=function(e,t){var i=this.imgStatusCache[e],n=this.getJqElem(e),s=i.scale*i.scalem,a=i.x+i.m,o=i.y+i.my,r="scale3d("+s+","+s+",1)  translate3d("+a+"px,"+o+"px,0px)",c="transform "+t+"s ease-out";this.addCssPrefix(n,"transition",c),this.addCssPrefix(n,"transform",r)},i.prototype.getJqElem=function(e){var t,e=void 0==e?this.index:e;if(e<=this.maxLen){var i=this.imgStatusCache[e].hash;t=this.imgLoadCache[i].elem}else{t=this.imgStatusCache[e].elem}return t},i.prototype.addCssPrefix=function(e,t,i){for(var n in this.cssprefix){if(""===this.cssprefix[n])t=t.toLowerCase();else{var s=t.length;t=t.substr(0,1).toUpperCase()+t.substr(1,s).toLowerCase()}if(void 0!==document.body.style[t])return void(e.style[t]=i)}},i.prototype.getTouches=function(e){var t=event.touches.length>0?event.touches:event.changedTouches,i={touches:t,length:t.length};return i.x0=t[0].pageX,i.y0=t[0].pageY,i.time=(new Date).getTime(),t.length>=2&&(i.x1=t[0].pageX,i.y1=t[1].pageY),i},e.previewImage=new i,"function"==typeof define&&define.amd&&define([],function(){return previewImage}),previewImage});