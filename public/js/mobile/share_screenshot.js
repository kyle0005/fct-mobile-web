"use strict";var app=new Vue({mounted:function(){var t=this;""!==t.imgObj.backgroundUrl&&null!==t.imgObj.backgroundUrl&&void 0!==t.imgObj.backgroundUrl?(t.showBtn=!1,t.drawTop()):t.drawCanvas()},data:{showAlert:!1,msg:config.msg,showBtn:!0,imgObj:config.imgObj,ratio:0},methods:{drawTop:function(){var t=this,e=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,o=null;o=document.createElement("canvas");var n=document.getElementById("con_result");o.width=e,o.height=i;var a=o.getContext("2d");t.ratio=function(t){var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e}(a),a.fillStyle="#ffffff",a.fillRect(0,0,e,i);var r=0,c=new Image;c.setAttribute("crossOrigin","anonymous"),c.src=t.imgObj.backgroundUrl,c.onload=function(){a.drawImage(c,0,0,e*t.ratio,c.height/c.width*e*t.ratio),2===(r+=1)&&n.appendChild(Canvas2Image.convertToImage(o,e,i));var l=new Image;l.setAttribute("crossOrigin","anonymous"),l.src=t.imgObj.qrcodeUrl,l.onload=function(){a.drawImage(l,(e-350/1242*e)/2*t.ratio,1165/1242*e*t.ratio,350/1242*e*t.ratio,350/1242*e*t.ratio),2===(r+=1)&&n.appendChild(Canvas2Image.convertToImage(o,e,i))}}},drawCanvas:function(){var t=this,e=window.innerWidth||document.documentElement.clientWidth,i=(window.innerHeight||document.documentElement.clientHeight,null);i=document.createElement("canvas");var o=document.getElementById("btn"),n=document.getElementById("con_result");i.width=e,i.height=970/750*e;var a=i.getContext("2d");t.ratio=function(t){var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e}(a),a.fillStyle="#ffffff",a.fillRect(0,0,e,970/750*e);var r=.04*e;a.fillStyle="#333",a.font="16px 微软雅黑",a.fillText(t.imgObj.name,r,e+70/750*e),a.fillStyle="#666",a.font="15px 微软雅黑",a.fillText(t.imgObj.artistName,r,e+.16*e),a.fillStyle="#993333",a.font="20px 微软雅黑",a.fillText(t.imgObj.price,r,e+.24*e);var c=0,l=new Image;l.setAttribute("crossOrigin","anonymous"),l.src=t.imgObj.defaultImage,l.onload=function(){a.drawImage(l,0,0,e*t.ratio,l.height/l.width*e*t.ratio),3===(c+=1)&&n.insertBefore(Canvas2Image.convertToImage(i,e,970/750*e),o);var r=new Image;r.setAttribute("crossOrigin","anonymous"),r.src=t.imgObj.qrcodeUrl,r.onload=function(){a.drawImage(r,464/750*e*t.ratio,.92*e*t.ratio,260/750*e*t.ratio,260/750*e*t.ratio),3===(c+=1)&&n.insertBefore(Canvas2Image.convertToImage(i,e,970/750*e),o)};var m=new Image;m.setAttribute("crossOrigin","anonymous"),m.src=t.imgObj.headPortrait,m.onload=function(){t.circleImg(a,m,32/750*e,32/750*e,100/750*e/2),3===(c+=1)&&n.insertBefore(Canvas2Image.convertToImage(i,e,970/750*e),o)}}},preImage:function(t,e,i){var o=new Image;if(o.src=t,o.complete)return void e.call(o,i);o.onload=function(){e.call(o,i)},o.onerror=function(){var o=+new Date;vue.preImage(t+"?"+o,e,i)}},circleImg:function(t,e,i,o,n){var a=this;t.save();var r=2*n,c=i+n,l=o+n;t.beginPath(),t.lineWidth=3,t.strokeStyle="#fff",t.arc(c,l,n,0,2*Math.PI),t.stroke(),t.closePath(),t.arc(c,l,n,0,2*Math.PI),t.clip(),t.drawImage(e,i*a.ratio,o*a.ratio,r*a.ratio,r*a.ratio),t.restore()},pop:function(){var t=this;t.showAlert=!0,t.close_auto()},close:function(){this.showAlert=!1},close_auto:function(t,e){var i=this;setTimeout(function(){i.showAlert=!1,t&&t(e)},1500)},linkto:function(t){t&&(location.href=t)}}}).$mount("#screenshot");