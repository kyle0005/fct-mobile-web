"use strict";new Vue({watch:{ischeck:function(){var t=this;t.choose_num=t.ischeck.length,t.caltotalpri()}},computed:{all:{get:function(){return!!this.pro_list&&this.ischeck.length==this.pro_list.length},set:function(t){var o=[];t&&this.pro_list.forEach(function(t){o.push(t)}),this.ischeck=o}}},data:function(){return{min:!1,max:!1,showAlert:!1,msg:null,pro_list:[],ischeck:[],choose_num:0,total_pri:0,like_list:[],callback:null,showConfirm:!1,cartItem:null,listloading:!1,nodata:!1}},mounted:function(){var t=this;t.loadPro(),t.show_like()},methods:{add:function(t){var o=this,i=parseInt(t.buyCount.toString().replace(/[^\d]/g,""));o.min&&(o.min=!1),i<t.stockCount&&(i+=1)===t.stockCount&&(o.max=!0),tools.ajaxPost(config.cart_add_url,{buy_number:i-t.buyCount,product_id:t.goodsId,spec_id:t.specId},o.postSuc,o.postBefore,o.postError,{},o.postTip),t.buyCount=i,o.caltotalpri()},minus:function(t,o){var i=this,n=parseInt(t.buyCount.toString().replace(/[^\d]/g,""));i.max&&(i.max=!1),n>1?(n-=1,0===n&&(i.min=!0),tools.ajaxPost(config.cart_minus_url,{buy_number:n-t.buyCount,product_id:t.goodsId,spec_id:t.specId},i.postSuc,i.postBefore,i.postError,{},i.postTip),t.buyCount=n):1===n&&(t.index=o,i.confirm(t,i.delCart)),i.caltotalpri()},delCart:function(t){var o=this,i=(parseInt(t.buyCount.toString().replace(/[^\d]/g,"")),config.delete_url+"/"+t.id+"/delete");tools.ajaxPost(i,{},o.delsuccess,o.postBefore,o.postError,t,o.postTip)},delsuccess:function(t,o){this.pro_list.splice(o.index,1)},postSuc:function(t){},postTip:function(t){var o=this;o.msg=t.message,o.showAlert=!0,o.close_auto()},postBefore:function(){},postError:function(){},caltotalpri:function(){var t=this;t.total_pri=0,t.ischeck.forEach(function(o){t.total_pri+=parseFloat(o.promotionPrice)*parseFloat(o.buyCount)}),t.total_pri=t.total_pri.toFixed(2)},close:function(){this.showAlert=!1},close_auto:function(t,o){var i=this;setTimeout(function(){i.showAlert=!1,t&&t(o)},1500)},show_like:function(){this.like_list=config.like_list},linkto:function(t){t&&(location.href="")},loadPro:function(){var t=this;t.listloading=!0,t.pro_list=config.carts,t.pro_list.length>0?t.nodata=!1:t.nodata=!0,t.listloading=!1},buy:function(){var t=this,o=[];t.ischeck.forEach(function(t){var i={};i.goodsId=t.goodsId,i.specId=t.specId,i.buyCount=t.buyCount,o.push(i)}),o.length>0&&(location.href=encodeURI(config.buy_url+"?product="+JSON.stringify(o)))},toFloat:function(t){return parseFloat(t).toFixed(2)},confirm:function(t,o){var i=this;i.msg="是否要移除该宝贝？",i.cartItem=t,i.callback=o,i.showConfirm=!0},no:function(){this.showConfirm=!1},ok:function(t,o){this.showConfirm=!1,t&&t(o)}}}).$mount("#cart");