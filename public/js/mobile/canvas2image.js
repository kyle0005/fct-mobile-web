"use strict";var Canvas2Image=function(){function t(t,e,n){var r=t.width,a=t.height;void 0==e&&(e=r),void 0==n&&(n=a);var o=document.createElement("canvas"),i=o.getContext("2d");return o.width=e,o.height=n,i.drawImage(t,0,0,r,a,0,0,e,n),o}function e(e,n,r,a){return e=t(e,r,a),e.toDataURL(n)}function n(t){document.location.href=t}function r(t){var e=document.createElement("img");return e.src=t,e}function a(t){return t=t.toLowerCase().replace(/jpg/i,"jpeg"),"image/"+t.match(/png|jpeg|bmp|gif/)[0]}function o(t){if(!window.btoa)throw"btoa undefined";var e="";if("string"==typeof t)e=t;else for(var n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function i(t){var e=t.width,n=t.height;return t.getContext("2d").getImageData(0,0,e,n)}function c(t,e){return"data:"+e+";base64,"+t}var u=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return{canvas:!!e,imageData:!!e.getImageData,dataURL:!!t.toDataURL,btoa:!!window.btoa}}(),g=function(t){var e=t.width,n=t.height,r=e*n*3,a=r+54,i=[66,77,255&a,a>>8&255,a>>16&255,a>>24&255,0,0,0,0,54,0,0,0],c=[40,0,0,0,255&e,e>>8&255,e>>16&255,e>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&r,r>>8&255,r>>16&255,r>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=(4-3*e%4)%4,g=t.data,f="",v=e<<2,m=n,d=String.fromCharCode;do{for(var s=v*(m-1),p="",h=0;h<e;h++){var b=h<<2;p+=d(g[s+b+2])+d(g[s+b+1])+d(g[s+b])}for(var l=0;l<u;l++)p+=String.fromCharCode(0);f+=p}while(--m);return o(i.concat(c))+o(f)},f=function(r,o,f,v){if(u.canvas&&u.dataURL)if("string"==typeof r&&(r=document.getElementById(r)),void 0==v&&(v="png"),v=a(v),/bmp/.test(v)){var m=i(t(r,o,f)),d=g(m);n(c(d,"image/octet-stream"))}else{var d=e(r,v,o,f);n(d.replace(v,"image/octet-stream"))}},v=function(n,o,f,v){if(u.canvas&&u.dataURL){if("string"==typeof n&&(n=document.getElementById(n)),void 0==v&&(v="png"),v=a(v),/bmp/.test(v)){var m=i(t(n,o,f)),d=g(m);return r(c(d,"image/bmp"))}var d=e(n,v,o,f);return r(d)}};return{saveAsImage:f,saveAsPNG:function(t,e,n){return f(t,e,n,"png")},saveAsJPEG:function(t,e,n){return f(t,e,n,"jpeg")},saveAsGIF:function(t,e,n){return f(t,e,n,"gif")},saveAsBMP:function(t,e,n){return f(t,e,n,"bmp")},convertToImage:v,convertToPNG:function(t,e,n){return v(t,e,n,"png")},convertToJPEG:function(t,e,n){return v(t,e,n,"jpeg")},convertToGIF:function(t,e,n){return v(t,e,n,"gif")},convertToBMP:function(t,e,n){return v(t,e,n,"bmp")}}}();