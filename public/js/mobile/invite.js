"use strict";var app=new Vue({mounted:function(){this.drawPic()},data:{username:config.user.userName,headportrait:config.user.headPortrait,qrcodeurl:config.qrcodeUrl,backgroundurl:config.backgroundUrl,logourl:config.logoUrl,textobj:config.textObj,ratio:0},methods:{drawPic:function(){var t=this;t.ratio=window.devicePixelRatio||1;var e=window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight||document.documentElement.clientHeight,i=null;i=document.createElement("canvas");var a=document.getElementById("con_result");i.width=e*t.ratio,i.height=o*t.ratio;var r=i.getContext("2d");r.mozImageSmoothingEnabled=!1,r.webkitImageSmoothingEnabled=!1,r.msImageSmoothingEnabled=!1,r.imageSmoothingEnabled=!1,r.fillStyle="#edece6",r.fillRect(0,0,e*t.ratio,o*t.ratio);var n=0,l=new Image;l.setAttribute("crossOrigin","anonymous"),l.src=t.backgroundurl,l.onload=function(){if(r.drawImage(l,0,0,e*t.ratio,l.height/l.width*e*t.ratio),4===(n+=1)){var c=Canvas2Image.convertToImage(i,e*t.ratio,o*t.ratio);c.style.width="100%",a.appendChild(c)}r.fillStyle="#993333",r.font=12*t.ratio+"px 微软雅黑",t.canvasTextAutoLine(t.username+t.textobj.textInfo,r,.256*e*t.ratio,.744*e*t.ratio,22*t.ratio,550/750*e*t.ratio),r.fillStyle="#666666",r.font=13*t.ratio+"px 微软雅黑",r.textAlign="center",r.fillText(t.textobj.textQrcode,.5*e*t.ratio,1060/750*e*t.ratio),r.fillStyle="#20201f",r.textAlign="left",r.font="bold "+17*t.ratio+"px 微软雅黑",r.fillText(t.textobj.textTip,55/750*e*t.ratio,1.56*e*t.ratio),r.fillStyle="#20201f",r.font="bold "+24*t.ratio+"px 微软雅黑",r.fillText(t.textobj.textM,55/750*e*t.ratio,1240/750*e*t.ratio),r.fillStyle="#20201f",r.font=12*t.ratio+"px 微软雅黑",r.fillText(t.textobj.textLine1,.12*e*t.ratio,1234/750*e*t.ratio),r.fillStyle="#20201f",r.font="bold "+24*t.ratio+"px 微软雅黑",r.fillText(t.textobj.textM,55/750*e*t.ratio,1283/750*e*t.ratio),r.fillStyle="#20201f",r.font=12*t.ratio+"px 微软雅黑",r.fillText(t.textobj.textLine2,.12*e*t.ratio,1277/750*e*t.ratio);var d=new Image;d.setAttribute("crossOrigin","anonymous"),d.src=t.headportrait,d.onload=function(){if(t.circleImg(r,d,.404*e,334/750*e,70/750*e),4===(n+=1)){var l=Canvas2Image.convertToImage(i,e*t.ratio,o*t.ratio);l.style.width="100%",a.appendChild(l)}};var g=new Image;g.setAttribute("crossOrigin","anonymous"),g.src=t.qrcodeurl,g.onload=function(){if(r.drawImage(g,.304*e*t.ratio,737/750*e*t.ratio,.392*e*t.ratio,.392*e*t.ratio),4===(n+=1)){var l=Canvas2Image.convertToImage(i,e*t.ratio,o*t.ratio);l.style.width="100%",a.appendChild(l)}};var f=new Image;f.setAttribute("crossOrigin","anonymous"),f.src=t.logourl,f.onload=function(){if(r.drawImage(f,646/750*e*t.ratio,1222/750*e*t.ratio,52/750*e*t.ratio,52/750*e*t.ratio),4===(n+=1)){var l=Canvas2Image.convertToImage(i,e*t.ratio,o*t.ratio);l.style.width="100%",a.appendChild(l)}}}},preImage:function(t,e,o){var i=new Image;if(i.src=t,i.complete)return void e.call(i,o);i.onload=function(){e.call(i,o)},i.onerror=function(){var i=+new Date;vue.preImage(t+"?"+i,e,o)}},circleImg:function(t,e,o,i,a){var r=this;t.save();var n=2*a,l=(o+a)*r.ratio,c=(i+a)*r.ratio;t.beginPath(),t.lineWidth=6*r.ratio,t.strokeStyle="#fff",t.arc(l,c,a*r.ratio,0,2*Math.PI),t.stroke(),t.closePath(),t.clip(),t.drawImage(e,o*r.ratio,i*r.ratio,n*r.ratio,n*r.ratio),t.restore()},canvasTextAutoLine:function(t,e,o,i,a,r){for(var n=0,l=r,c=0,d=0;d<t.length;d++)n+=e.measureText(t[d]).width,n>l-o&&(e.fillText(t.substring(c,d),o,i),i+=a,n=0,c=d),d==t.length-1&&e.fillText(t.substring(c,d+1),o,i)}}}).$mount("#invite");