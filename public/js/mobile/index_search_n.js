"use strict";var app=new Vue({mounted:function(){var o=this;o.initData(),window.addEventListener("scroll",function(){o.showTop=tools.getScrollTop()>=tools.getWindowHeight()},!1)},data:{filter:config.filter,open:!1,docked:!1,showPop:0,sorts:config.search.sorts,artists:config.search.artists,priceSorts:config.search.priceSorts,volumes:config.search.volumes,categorys:config.search.categorys,lowpri:0,highpri:0,lowpri_cache:0,highpri_cache:0,priV:null,lowvol:0,highvol:0,lowvol_cache:0,highvol_cache:0,showTop:!1,search:config.search.keyword||"",result:[],pager:config.result.pager,_url:"",sorts_code:0,artists_code:0,cate_code:"",sort_tab:0,art_tab:-1,pri_tab:-1,vol_tab:-1,cat_tab:-1,pri_cache_tab:-1,vol_cache_tab:-1,tmp_vol_min_obj:{},tmp_vol_max_obj:{},preventRepeatReuqest:!1,last_url:"",listloading:!0,pagerloading:!1,isPage:!1,nodata:!1,isLastPage:!1,showAlert:!1,msg:null},watch:{result:function(o,t){this.listloading||(this.result&&this.result.length>0?this.nodata=!1:this.nodata=!0)},lowvol_cache:function(o,t){var e=this;e.tmp_vol_min_obj={},e.volumes.forEach(function(t,a){o==t.min&&(e.tmp_vol_min_obj=t,e.tmp_vol_min_obj.index=a)}),e.tmp_vol_min_obj.min==e.tmp_vol_max_obj.min&&e.tmp_vol_min_obj.max==e.tmp_vol_max_obj.max?e.vol_cache_tab=e.tmp_vol_min_obj.index:e.vol_cache_tab=-1},highvol_cache:function(o,t){var e=this;e.tmp_vol_max_obj={},e.volumes.forEach(function(t,a){o==t.max&&(e.tmp_vol_max_obj=t,e.tmp_vol_max_obj.index=a)}),e.tmp_vol_min_obj.min==e.tmp_vol_max_obj.min&&e.tmp_vol_min_obj.max==e.tmp_vol_max_obj.max?e.vol_cache_tab=e.tmp_vol_max_obj.index:e.vol_cache_tab=-1}},methods:{toggle:function(o){var t=this;-1===o?(t.open=!1,t.docked=!1,t.lowpri_cache=t.lowpri,t.highpri_cache=t.highpri,t.lowvol_cache=t.lowvol,t.highvol_cache=t.highvol,t.pri_cache_tab=t.pri_tab,t.vol_cache_tab=t.vol_tab):(o!==t.showPop&&(t.open=!1,t.docked=!1,t.showPop=o),setTimeout(function(){t.docked=!t.docked,t.open=!t.open},50))},changeS:function(o,t,e){var a=this;-10!==o&&(a.sorts_code=o),-10!==t&&(a.artists_code=t),null!==e&&(a.cate_code=e);var i=a._url+"&sort="+(a.priV||a.sorts_code)+"&price_min="+a.lowpri+"&price_max="+a.highpri+"&author="+a.artists_code+"&volume_min="+a.lowvol+"&volume_max="+a.highvol+"&category_id="+a.cate_code;console.log(i),tools.ajaxGet(i,a.searchSuc,a.getBefore)},sortsV:function(o,t){var e=this;e.sort_tab=t,e.pri_tab=-1,e.priV=null,e.changeS(o.value,-10,null)},artistsV:function(o,t){var e=this;t==e.art_tab?(e.art_tab=-1,e.changeS(-10,0,null)):(e.art_tab=t,e.changeS(-10,o.value,null))},priceSortsVn:function(o,t){var e=this;e.pri_tab=t,e.sort_tab=-1,e.priV=o.value,e.changeS(-10,-10,null)},priceSortsV:function(o){var t=this;o==t.pri_cache_tab?t.pri_cache_tab=-1:t.pri_cache_tab=o},priceSortsVOK:function(){var o=this;o.priceSorts[o.pri_cache_tab]&&o.priceSorts[o.pri_cache_tab].value&&(o.priV=o.priceSorts[o.pri_cache_tab].value,o.sort_tab=-1),-1==o.pri_cache_tab&&(o.priV=null),o.lowpri=o.lowpri_cache,o.highpri=o.highpri_cache,o.pri_tab=o.pri_cache_tab,o.changeS(-10,-10,null)},volumesV:function(o){var t=this;o==t.vol_cache_tab?(t.vol_cache_tab=-1,t.lowvol_cache=0,t.highvol_cache=0):(t.vol_cache_tab=o,t.lowvol_cache=t.volumes[t.vol_cache_tab].min,t.highvol_cache=t.volumes[t.vol_cache_tab].max)},volumesVOK:function(){var o=this;o.lowvol=o.lowvol_cache,o.highvol=o.highvol_cache,o.vol_tab=o.vol_cache_tab,o.changeS(-10,-10,null)},categorysV:function(o,t){var e=this;e.cat_tab=t,e.changeS(-10,-10,o.code)},initData:function(){var o=this;o._url=config.url+"?keyword="+o.search,o.result=config.result.entries,o.pager=config.result.pager,o.listloading=!1,o.filter&&(o.search=o.filter.keyword,o.cate_code=o.filter.category_id,o.artists_code=o.filter.artist_id,o.lowvol=o.filter.volume_min,o.highvol=o.filter.volume_max,o.lowvol_cache=o.filter.volume_min,o.highvol_cache=o.filter.volume_max,o.lowpri=o.filter.price_min,o.highpri=o.filter.price_max,o.lowpri_cache=o.filter.price_min,o.highpri_cache=o.filter.price_max,o.sorts_code=o.filter.sort,o.filter.sort>2?o.priceSorts.forEach(function(t,e){o.filter.sort==t.value&&(o.pri_tab=e)}):o.sorts.forEach(function(t,e){o.filter.sort==t.value&&(o.sort_tab=e)}))},nextPage:function(){var o=this;if(o.preventRepeatReuqest=!0,o.pager.next>0){var t=o._url+"&sort="+(o.priV||o.sorts_code)+"&price_min="+o.lowpri+"&price_max="+o.highpri+"&author="+o.artists_code+"&volume_min="+o.lowvol+"&volume_max="+o.highvol+"&category_id="+o.cate_code+"&page="+o.pager.next;t!==o.last_url&&(o.last_url=t,o.isPage=!0,tools.ajaxGet(t,o.nextSucc,o.getBefore))}else o.isLastPage=!0},nextSucc:function(o){var t=this;t.pager=o.data.pager,t.result=t.result.concat(o.data.entries),t.preventRepeatReuqest=!1,t.listloading=!1,t.pagerloading=!1,t.isPage=!1},getBefore:function(){var o=this;o.isPage?o.pagerloading=!0:o.listloading=!0},clear:function(){this.search=""},rej:function(){return!0},subSearch:function(o){var t=this;if(t.nodata=!1,t.search&&""!==t.search)t._url=config.url+"?keyword="+t.search,tools.ajaxGet(t._url,t.searchSuc,t.getBefore);else{var e=config.search.keyword;void 0==e&&(e=""),t._url=config.url+"?keyword="+e,tools.ajaxGet(t._url,t.searchSuc,t.getBefore)}},searchSuc:function(o){var t=this;t.result=[],t.pager=o.data.pager,t.result=o.data.entries,t.listloading=!1,t.toggle(-1)},end:function(){console.log("end")},top:function(){tools.animate(document,{scrollTop:"0"},400,"ease-out")}}}).$mount("#isearch");