"use strict";var app=new Vue({mounted:function(){var e=this;e.initData(),window.addEventListener("scroll",function(){e.showTop=tools.getScrollTop()>=tools.getWindowHeight()},!1)},data:{open:!1,docked:!1,showPop:0,sorts:config.search.sorts,artists:config.search.artists,priceSorts:config.search.priceSorts,volumes:config.search.volumes,categorys:config.search.categorys,lowpri:0,highpri:0,priV:null,lowvol:0,highvol:0,showTop:!1,search:config.search.keyword||"",result:[],pager:config.result.pager,_url:"",sorts_code:0,artists_code:0,cate_code:"",sort_tab:-1,art_tab:-1,pri_tab:-1,vol_tab:-1,cat_tab:-1,pri_cache_tab:-1,vol_cache_tab:-1,preventRepeatReuqest:!1,last_url:"",listloading:!0,pagerloading:!1,isPage:!1,nodata:!1,showAlert:!1,msg:null},watch:{result:function(e,t){this.listloading||(this.result&&this.result.length>0?this.nodata=!1:this.nodata=!0)}},methods:{toggle:function(e){var t=this;-1===e?(t.open=!1,t.docked=!1,t.pri_cache_tab=t.pri_tab,t.vol_cache_tab=t.vol_tab):(e!==t.showPop&&(t.open=!1,t.docked=!1,t.showPop=e),setTimeout(function(){t.docked=!t.docked,t.open=!t.open},50))},changeS:function(e,t,o){var a=this;-10!==e&&(a.sorts_code=e),-10!==t&&(a.artists_code=t),null!==o&&(a.cate_code=o);var r=a._url+"&sort="+(a.priV|a.sorts_code)+"&price_min="+a.lowpri+"&price_max="+a.highpri+"&author="+a.artists_code+"&volume_min="+a.lowvol+"&volume_max="+a.highvol+"&category_id="+a.cate_code;console.log(r),tools.ajaxGet(r,a.searchSuc,a.getBefore)},sortsV:function(e,t){var o=this;o.sort_tab=t,o.changeS(e.value,-10,null)},artistsV:function(e,t){var o=this;o.art_tab=t,o.changeS(-10,e.value,null)},priceSortsV:function(e){this.pri_cache_tab=e},priceSortsVOK:function(){var e=this;e.priceSorts[e.pri_cache_tab]&&e.priceSorts[e.pri_cache_tab].value&&(e.priV=e.priceSorts[e.pri_cache_tab].value),e.pri_tab=e.pri_cache_tab,e.changeS(-10,-10,null)},volumesV:function(e){this.vol_cache_tab=e},volumesVOK:function(){var e=this;e.volumes[e.vol_cache_tab]&&e.volumes[e.vol_cache_tab].min&&e.lowvol<1&&(e.lowvol=e.volumes[e.vol_cache_tab].min),e.volumes[e.vol_cache_tab]&&e.volumes[e.vol_cache_tab].max&&e.highvol<1&&(e.highvol=e.volumes[e.vol_cache_tab].max),e.vol_tab=e.vol_cache_tab,e.changeS(-10,-10,null)},categorysV:function(e,t){var o=this;o.cat_tab=t,o.changeS(-10,-10,e.code)},initData:function(){var e=this;e._url=config.url+"?keyword="+e.search,e.result=config.result.entries,e.pager=config.result.pager,e.listloading=!1},nextPage:function(){var e=this;if(e.preventRepeatReuqest=!0,e.pager.next>0){var t=e._url+"&sort="+(e.priV|e.sorts_code)+"&price_min="+e.lowpri+"&price_max="+e.highpri+"&author="+e.artists_code+"&volume_min="+e.lowvol+"&volume_max="+e.highvol+"&category_id="+e.cate_code+"&page="+e.pager.next;t!==e.last_url&&(e.last_url=t,e.isPage=!0,tools.ajaxGet(t,e.nextSucc,e.getBefore))}},nextSucc:function(e){var t=this;t.pager=e.data.pager,t.result=t.result.concat(e.data.entries),t.preventRepeatReuqest=!1,t.listloading=!1,t.pagerloading=!1,t.isPage=!1},getBefore:function(){var e=this;e.isPage?e.pagerloading=!0:e.listloading=!0},subSearch:function(){var e=this;if(e.nodata=!1,e.search&&""!==e.search)e._url=config.url+"?keyword="+e.search,tools.ajaxGet(e._url,e.searchSuc,e.getBefore);else{var t=config.search.keyword;void 0==t&&(t=""),e._url=config.url+"?keyword="+t,tools.ajaxGet(e._url,e.searchSuc,e.getBefore)}},searchSuc:function(e){var t=this;t.result=[],t.pager=e.data.pager,t.result=e.data.entries,t.listloading=!1,t.toggle(-1)},end:function(){console.log("end")},top:function(){tools.animate(document,{scrollTop:"0"},400,"ease-out")}}}).$mount("#isearch");