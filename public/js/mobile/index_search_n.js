"use strict";var app=new Vue({mounted:function(){var o=this;o.initData(),window.addEventListener("scroll",function(){o.showTop=tools.getScrollTop()>=tools.getWindowHeight()},!1)},data:{filter:config.filter,open:!1,docked:!1,showPop:0,sorts:config.search.sorts,artists:config.search.artists,priceSorts:config.search.priceSorts,volumes:config.search.volumes,categorys:config.search.categorys,lowpri:0,highpri:0,lowpri_cache:0,highpri_cache:0,priV:null,lowvol:0,highvol:0,lowvol_cache:0,highvol_cache:0,showTop:!1,search:config.search.keyword||"",result:[],pager:config.result.pager,_url:"",sorts_code:0,artists_code:0,cate_code:"",sort_tab:0,art_tab:-1,pri_tab:-1,vol_tab:-1,cat_tab:-1,pri_cache_tab:-1,vol_cache_tab:-1,tmp_vol_min_obj:{},tmp_vol_max_obj:{},preventRepeatReuqest:!1,last_url:"",listloading:!0,pagerloading:!1,isPage:!1,nodata:!1,isLastPage:!1,showAlert:!1,msg:null},watch:{result:function(o,e){this.listloading||(this.result&&this.result.length>0?this.nodata=!1:this.nodata=!0)},lowvol_cache:function(o,e){var t=this;t.tmp_vol_min_obj={},t.volumes.forEach(function(e,a){o==e.min&&(t.tmp_vol_min_obj=e,t.tmp_vol_min_obj.index=a)}),t.tmp_vol_min_obj.min==t.tmp_vol_max_obj.min&&t.tmp_vol_min_obj.max==t.tmp_vol_max_obj.max?t.vol_cache_tab=t.tmp_vol_min_obj.index:t.vol_cache_tab=-1},highvol_cache:function(o,e){var t=this;t.tmp_vol_max_obj={},t.volumes.forEach(function(e,a){o==e.max&&(t.tmp_vol_max_obj=e,t.tmp_vol_max_obj.index=a)}),t.tmp_vol_min_obj.min==t.tmp_vol_max_obj.min&&t.tmp_vol_min_obj.max==t.tmp_vol_max_obj.max?t.vol_cache_tab=t.tmp_vol_max_obj.index:t.vol_cache_tab=-1}},methods:{toggle:function(o){var e=this;-1===o?(e.open=!1,e.docked=!1,e.lowpri_cache=e.lowpri,e.highpri_cache=e.highpri,e.lowvol_cache=e.lowvol,e.highvol_cache=e.highvol,e.pri_cache_tab=e.pri_tab,e.vol_cache_tab=e.vol_tab):(o!==e.showPop&&(e.open=!1,e.docked=!1,e.showPop=o),setTimeout(function(){e.docked=!e.docked,e.open=!e.open},50))},changeS:function(o,e,t){var a=this;-10!==o&&(a.sorts_code=o),-10!==e&&(a.artists_code=e),null!==t&&(a.cate_code=t);var i=a._url+"&sort="+(a.priV|a.sorts_code)+"&price_min="+a.lowpri+"&price_max="+a.highpri+"&author="+a.artists_code+"&volume_min="+a.lowvol+"&volume_max="+a.highvol+"&category_id="+a.cate_code;console.log(i),tools.ajaxGet(i,a.searchSuc,a.getBefore)},sortsV:function(o,e){var t=this;t.sort_tab=e,t.priV=null,t.changeS(o.value,-10,null)},artistsV:function(o,e){var t=this;e==t.art_tab?(t.art_tab=-1,t.changeS(-10,0,null)):(t.art_tab=e,t.changeS(-10,o.value,null))},priceSortsV:function(o){var e=this;o==e.pri_cache_tab?e.pri_cache_tab=-1:e.pri_cache_tab=o},priceSortsVOK:function(){var o=this;o.priceSorts[o.pri_cache_tab]&&o.priceSorts[o.pri_cache_tab].value&&(o.priV=o.priceSorts[o.pri_cache_tab].value,o.sort_tab=-1),-1==o.pri_cache_tab&&(o.priV=null),o.lowpri=o.lowpri_cache,o.highpri=o.highpri_cache,o.pri_tab=o.pri_cache_tab,o.changeS(-10,-10,null)},volumesV:function(o){var e=this;o==e.vol_cache_tab?(e.vol_cache_tab=-1,e.lowvol_cache=0,e.highvol_cache=0):(e.vol_cache_tab=o,e.lowvol_cache=e.volumes[e.vol_cache_tab].min,e.highvol_cache=e.volumes[e.vol_cache_tab].max)},volumesVOK:function(){var o=this;o.lowvol=o.lowvol_cache,o.highvol=o.highvol_cache,o.vol_tab=o.vol_cache_tab,o.changeS(-10,-10,null)},categorysV:function(o,e){var t=this;t.cat_tab=e,t.changeS(-10,-10,o.code)},initData:function(){var o=this;o._url=config.url+"?keyword="+o.search,o.result=config.result.entries,o.pager=config.result.pager,o.listloading=!1,o.filter&&(o.search=o.filter.keyword,o.cate_code=o.filter.category_id,o.artists_code=o.filter.artist_id,o.lowvol=o.filter.volume_min,o.highvol=o.filter.volume_max,o.lowvol_cache=o.filter.volume_min,o.highvol_cache=o.filter.volume_max,o.lowpri=o.filter.price_min,o.highpri=o.filter.price_max,o.lowpri_cache=o.filter.price_min,o.highpri_cache=o.filter.price_max,o.sorts_code=o.filter.sort,o.filter.sort>2?o.priceSorts.forEach(function(e,t){o.filter.sort==e.value&&(o.pri_tab=t)}):o.sorts.forEach(function(e,t){o.filter.sort==e.value&&(o.sort_tab=t)}))},nextPage:function(){var o=this;if(o.preventRepeatReuqest=!0,o.pager.next>0){var e=o._url+"&sort="+(o.priV|o.sorts_code)+"&price_min="+o.lowpri+"&price_max="+o.highpri+"&author="+o.artists_code+"&volume_min="+o.lowvol+"&volume_max="+o.highvol+"&category_id="+o.cate_code+"&page="+o.pager.next;e!==o.last_url&&(o.last_url=e,o.isPage=!0,tools.ajaxGet(e,o.nextSucc,o.getBefore))}else o.isLastPage=!0},nextSucc:function(o){var e=this;e.pager=o.data.pager,e.result=e.result.concat(o.data.entries),e.preventRepeatReuqest=!1,e.listloading=!1,e.pagerloading=!1,e.isPage=!1},getBefore:function(){var o=this;o.isPage?o.pagerloading=!0:o.listloading=!0},subSearch:function(){var o=this;if(o.nodata=!1,o.search&&""!==o.search)o._url=config.url+"?keyword="+o.search,tools.ajaxGet(o._url,o.searchSuc,o.getBefore);else{var e=config.search.keyword;void 0==e&&(e=""),o._url=config.url+"?keyword="+e,tools.ajaxGet(o._url,o.searchSuc,o.getBefore)}},searchSuc:function(o){var e=this;e.result=[],e.pager=o.data.pager,e.result=o.data.entries,e.listloading=!1,e.toggle(-1)},end:function(){console.log("end")},top:function(){tools.animate(document,{scrollTop:"0"},400,"ease-out")}}}).$mount("#isearch");