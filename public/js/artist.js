"use strict";Vue.component("mVideo",{template:"#m_video",data:function(){return{isVideoLoad:!1}},mounted:function(){},props:{poster:{type:String,default:""},url:{type:String,default:""},id:{type:String,default:""}},methods:{loadVideo:function(){var t=this;t.isVideoLoad=!0,t.$nextTick(function(){document.getElementById(t.id).play()})}}}),Vue.component("live",{template:"#live",computed:{topImg:function(){var t=this,e=!1,o=[];return config.artist.dynamicList.entries.forEach(function(e,i){e.isTop?t.top=e:o.push(e)}),t.liveList=o,t.top.images.length>0&&(e=!0),e}},directives:{"load-more":{bind:function(t,e){var o=window.screen.height,i=void 0,n=void 0,a=void 0,s=void 0,c=void 0,r=void 0,l=void 0,u=void 0,d=t.attributes.type&&t.attributes.type.value;2==d?(l=t,u=t.children[0]):(l=document.body,u=t),t.addEventListener("touchstart",function(){i=u.clientHeight,2==d&&(i=i),n=t.offsetTop,a=tools.getStyle(t,"paddingBottom"),s=tools.getStyle(t,"marginBottom")},!1),t.addEventListener("touchmove",function(){f()},!1),t.addEventListener("touchend",function(){r=l.scrollTop,p()},!1);var p=function t(){c=requestAnimationFrame(function(){l.scrollTop!=r?(r=l.scrollTop,t()):(cancelAnimationFrame(c),i=u.clientHeight,f())})},f=function(){l.scrollTop+o>=i+n+a+s-2&&e.value()}}}},mounted:function(){},data:function(){return{dynamicList:config.artist.dynamicList,liveList:[],top:{},preventRepeatReuqest:!1,last_url:"",isVideoLoad:!1,listloading:!1,nodata:!1}},methods:{getBefore:function(){this.listloading=!0},nextPage:function(){var t=this;if(t.preventRepeatReuqest=!0,t.dynamicList.pager.next>0){var e=config.artistPage_url+"?page="+t.dynamicList.pager.next;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.pageSucc,t.getBefore))}},pageSucc:function(t){var e=this;e.dynamicList=t.data,e.liveList=t.data.entries.concat(e.liveList),e.loadLive(),e.preventRepeatReuqest=!1,e.listloading=!1},loadLive:function(){var t=this;t.liveList.forEach(function(e,o){if(e.isTop){var i=t.liveList;t.liveList=[],i.splice(o,1),t.liveList=i}})}}}),Vue.component("works",{template:"#works",mounted:function(){this.loadWorks()},data:function(){return{workslist:[],last_url:"",listloading:!1,nodata:!1}},methods:{getBefore:function(){this.listloading=!0},loadWorks:function(){var t=this,e=config.artistWorks_url;e!==t.last_url&&(t.last_url=e,t.nodata=!1,tools.ajaxGet(e,t.workSucc,t.getBefore))},workSucc:function(t){var e=this;e.workslist=t.data,e.listloading=!1,e.workslist.length>0?e.nodata=!1:e.nodata=!0}}}),Vue.component("chat",{template:"#chat",computed:{},directives:{"load-more":{bind:function(t,e){var o=window.screen.height,i=void 0,n=void 0,a=void 0,s=void 0,c=void 0,r=void 0,l=void 0,u=void 0,d=t.attributes.type&&t.attributes.type.value;2==d?(l=t,u=t.children[0]):(l=document.body,u=t),t.addEventListener("touchstart",function(){i=u.clientHeight,2==d&&(i=i),n=t.offsetTop,a=tools.getStyle(t,"paddingBottom"),s=tools.getStyle(t,"marginBottom")},!1),t.addEventListener("touchmove",function(){f()},!1),t.addEventListener("touchend",function(){r=l.scrollTop,p()},!1);var p=function t(){c=requestAnimationFrame(function(){l.scrollTop!=r?(r=l.scrollTop,t()):(cancelAnimationFrame(c),i=u.clientHeight,f())})},f=function(){l.scrollTop+o>=i+n+a+s-2&&e.value()}}}},mounted:function(){this.loadChat()},data:function(){return{chatlist:[],last_url:"",pager:{},open:!1,docked:!1,preventRepeatReuqest:!1,showAlert:!1,msg:null,message:"",subText:"发送",listloading:!1,nodata:!1}},methods:{getBefore:function(){this.listloading=!0},nextPage:function(){var t=this;if(t.preventRepeatReuqest=!0,t.pager.next>0){var e=config.artistChat_url+"?page="+t.pager.next;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.pageSucc,t.getBefore))}},pageSucc:function(t){var e=this;e.pager=t.data.pager,e.chatlist=t.data.entries.concat(e.chatlist),e.preventRepeatReuqest=!1,e.listloading=!1},popchat:function(){var t=this;t.open?(t.open=!1,setTimeout(function(){t.docked=!1},300)):(t.docked=!0,t.open=!0)},send:function(){var t=this,e={message:t.message};t.$refs.subpost.post(config.chat_url,e)},loadChat:function(){var t=this,e=config.artistChat_url;e!==t.last_url&&(t.last_url=e,t.nodata=!1,tools.ajaxGet(e,t.chatSucc,t.getBefore))},chatSucc:function(t){var e=this;e.chatlist=t.data.entries,e.pager=t.data.pager,e.listloading=!1,e.chatlist.length>0?e.nodata=!1:e.nodata=!0},succhandle:function(t){var e=this;e.msg="留言提交成功，我们将通知“"+config.artist.name+"”给您回复，请留意！",e.showAlert=!0,t.url?e.close_auto(e.linkto,t.url):e.close_auto(),e.popchat()},close:function(){this.showAlert=!1},close_auto:function(t,e){var o=this;setTimeout(function(){o.showAlert=!1,t&&t(e)},1500)},linkto:function(t){t&&(location.href=t)}}});var app=new Vue({computed:{},mounted:function(){},activated:function(){},deactivated:function(){},data:{haslive:!0,currentView:"live",tabs:["实时动态","相关作品","对话艺人"],tab_num:0,artist:config.artist},watch:{},methods:{linkTo:function(t){var e=this;switch(this.tab_num=t,parseInt(t)){case 0:e.currentView="live";break;case 1:e.currentView="works";break;case 2:e.currentView="chat";break;default:e.currentView="live"}}},components:{}}).$mount("#artist");