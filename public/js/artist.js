"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var photo_html='<div class="photogallery-container"><transition appear name="v-img-fade"><div v-if="!closed" class="fullscreen-v-img" @click.self="close()"><div class="header-v-img"><span v-if="images.length > 1" class="count-v-img">{{ currentImageIndex + 1 }}/{{ images.length }}</span><span class="close-v-img" @click="close">&times;</span></div><transition appear name="v-img-fade"><span v-if="visibleUI && images.length !== 1" class="prev-v-img" @click="prev"><svg width="25" height="25" viewBox="0 0 1792 1915" xmlns="http://www.w3.org/2000/svg"><path d="M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z" fill="#fff"/></svg></span></transition><transition appear name="v-img-fade"><span v-if="visibleUI && images.length !== 1" class="next-v-img" @click="next"><svg width="25" height="25" viewBox="0 0 1792 1915" xmlns="http://www.w3.org/2000/svg"><path d="M1600 960q0 54-37 91l-651 651q-39 37-91 37-51 0-90-37l-75-75q-38-38-38-91t38-91l293-293h-704q-52 0-84.5-37.5t-32.5-90.5v-128q0-53 32.5-90.5t84.5-37.5h704l-293-294q-38-36-38-90t38-90l75-75q38-38 90-38 53 0 91 38l651 651q37 35 37 90z" fill="#fff"/></svg></span></transition><div class="content-v-img"><img :src="images[currentImageIndex]" @click="next"></div></div></transition></div>',screen=Vue.extend({template:photo_html,data:function(){return{images:[],visibleUI:!0,currentImageIndex:0,closed:!0,uiTimeout:null}},methods:{close:function(){document.querySelector("body").classList.remove("body-fs-v-img"),this.images=[],this.currentImageIndex=0,this.closed=!0},next:function(){this.currentImageIndex+1<this.images.length?this.currentImageIndex++:this.currentImageIndex=0},prev:function(){this.currentImageIndex>0?this.currentImageIndex--:this.currentImageIndex=this.images.length-1},showUI:function(){var t=this;clearTimeout(this.uiTimeout),this.visibleUI=!0,this.uiTimeout=setTimeout(function(){t.visibleUI=!1},3500)}},created:function(){var t=this;window.addEventListener("keyup",function(e){27!==e.keyCode&&81!==e.keyCode||t.close(),39!==e.keyCode&&76!==e.keyCode||t.next(),37!==e.keyCode&&72!==e.keyCode||t.prev()}),window.addEventListener("scroll",function(){t.close()}),window.addEventListener("mousemove",function(){t.showUI()})}});Vue.directive("img",{bind:function(t,e){var i="pointer",n=t.lsrc,o=e.arg||null;void 0!==e.value&&(i=e.value.cursor||i,n=e.value.lsrc,o=e.value.group||o),t.setAttribute("data-vue-img-group",o||null),e.value&&e.value.lsrc&&t.setAttribute("data-vue-img-src",e.value.lsrc),n||console.error("v-img element missing src parameter."),t.style.cursor=i;var a=window.vueImg;if(!a){var s=document.createElement("div");s.setAttribute("id","imageScreen"),document.querySelector("body").appendChild(s),a=window.vueImg=(new screen).$mount("#imageScreen")}t.addEventListener("click",function(){document.querySelector("body").classList.add("body-fs-v-img");var e=[].concat(_toConsumableArray(document.querySelectorAll('img[data-vue-img-group="'+o+'"]')));0==e.length?Vue.set(a,"images",[n]):(Vue.set(a,"images",e.map(function(t){return t.dataset.vueImgSrc||n})),Vue.set(a,"currentImageIndex",e.indexOf(t))),Vue.set(a,"closed",!1)})}}),Vue.component("mVideo",{template:"#m_video",data:function(){return{isVideoLoad:!1}},mounted:function(){},props:{poster:{type:String,default:""},url:{type:String,default:""},id:{type:String,default:""}},methods:{loadVideo:function(){var t=this;t.isVideoLoad=!0,t.$nextTick(function(){document.getElementById(t.id).play()})}}}),Vue.component("live",{template:"#live",computed:{topImg:function(){var t=this,e=!1,i=[];return config.artist.dynamicList.entries.forEach(function(e,n){e.isTop?t.top=e:i.push(e)}),t.liveList=i,t.top.images.length>0&&(e=!0),e}},directives:{"load-more":{bind:function(t,e){var i=window.screen.height,n=void 0,o=void 0,a=void 0,s=void 0,r=void 0,c=void 0,l=void 0,u=void 0,d=t.attributes.type&&t.attributes.type.value;2==d?(l=t,u=t.children[0]):(l=document.body,u=t),t.addEventListener("touchstart",function(){n=u.clientHeight,2==d&&(n=n),o=t.offsetTop,a=tools.getStyle(t,"paddingBottom"),s=tools.getStyle(t,"marginBottom")},!1),t.addEventListener("touchmove",function(){m()},!1),t.addEventListener("touchend",function(){c=l.scrollTop,v()},!1);var v=function t(){r=requestAnimationFrame(function(){l.scrollTop!=c?(c=l.scrollTop,t()):(cancelAnimationFrame(r),n=u.clientHeight,m())})},m=function(){l.scrollTop+i>=n+o+a+s-2&&e.value()}}}},mounted:function(){},data:function(){return{dynamicList:config.artist.dynamicList,liveList:[],top:{},preventRepeatReuqest:!1,last_url:"",isVideoLoad:!1,listloading:!1}},methods:{getBefore:function(){this.listloading=!0},nextPage:function(){var t=this;document.body.scrollTop,document.body.clientHeight,document.body.scrollHeight;if(t.preventRepeatReuqest=!0,t.dynamicList.pager.next>0){var e=config.artistPage_url+"?page="+t.dynamicList.pager.next;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.pageSucc,t.getBefore))}},pageSucc:function(t){var e=this;e.dynamicList=t.data,e.liveList=t.data.entries.concat(e.liveList),e.loadLive(),e.preventRepeatReuqest=!1,e.listloading=!1},loadLive:function(){var t=this;t.liveList.forEach(function(e,i){if(e.isTop){var n=t.liveList;t.liveList=[],n.splice(i,1),t.liveList=n}})}}}),Vue.component("works",{template:"#works",mounted:function(){this.loadWorks()},data:function(){return{workslist:[],last_url:"",listloading:!1}},methods:{getBefore:function(){this.listloading=!0},loadWorks:function(){var t=this,e=config.artistWorks_url;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.workSucc,t.getBefore))},workSucc:function(t){var e=this;e.workslist=t.data,e.listloading=!1}}}),Vue.component("chat",{template:"#chat",computed:{},directives:{"load-more":{bind:function(t,e){var i=window.screen.height,n=void 0,o=void 0,a=void 0,s=void 0,r=void 0,c=void 0,l=void 0,u=void 0,d=t.attributes.type&&t.attributes.type.value;2==d?(l=t,u=t.children[0]):(l=document.body,u=t),t.addEventListener("touchstart",function(){n=u.clientHeight,2==d&&(n=n),o=t.offsetTop,a=tools.getStyle(t,"paddingBottom"),s=tools.getStyle(t,"marginBottom")},!1),t.addEventListener("touchmove",function(){m()},!1),t.addEventListener("touchend",function(){c=l.scrollTop,v()},!1);var v=function t(){r=requestAnimationFrame(function(){l.scrollTop!=c?(c=l.scrollTop,t()):(cancelAnimationFrame(r),n=u.clientHeight,m())})},m=function(){l.scrollTop+i>=n+o+a+s-2&&e.value()}}}},mounted:function(){this.loadChat()},data:function(){return{chatlist:[],last_url:"",pager:{},open:!1,docked:!1,preventRepeatReuqest:!1,showAlert:!1,msg:null,message:"",subText:"发送",listloading:!1}},methods:{getBefore:function(){this.listloading=!0},nextPage:function(){var t=this;if(t.preventRepeatReuqest=!0,t.pager.next>0){var e=config.artistChat_url+"?page="+t.pager.next;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.pageSucc,t.getBefore))}},pageSucc:function(t){var e=this;e.pager=t.data.pager,e.chatlist=t.data.entries.concat(e.chatlist),e.preventRepeatReuqest=!1,e.listloading=!1},popchat:function(){var t=this;t.open?(t.open=!1,setTimeout(function(){t.docked=!1},300)):(t.docked=!0,t.open=!0)},send:function(){var t=this,e={message:t.message};t.$refs.subpost.post(config.chat_url,e)},loadChat:function(){var t=this,e=config.artistChat_url;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.chatSucc,t.getBefore))},chatSucc:function(t){var e=this;e.chatlist=t.data.entries,e.pager=t.data.pager,e.listloading=!1},succhandle:function(t){var e=this;e.msg="留言提交成功，我们将通知“"+config.artist.name+"”给您回复，请留意！",e.showAlert=!0,t.url?e.close_auto(e.linkto,t.url):e.close_auto(),e.popchat()},close:function(){this.showAlert=!1},close_auto:function(t,e){var i=this;setTimeout(function(){i.showAlert=!1,t&&t(e)},1500)},linkto:function(t){t&&(location.href=t)}}});var app=new Vue({computed:{},mounted:function(){},activated:function(){},deactivated:function(){},data:{haslive:!0,currentView:"live",tabs:["实时动态","相关作品","对话艺人"],tab_num:0,artist:config.artist},watch:{},methods:{linkTo:function(t){var e=this;switch(this.tab_num=t,parseInt(t)){case 0:e.currentView="live";break;case 1:e.currentView="works";break;case 2:e.currentView="chat";break;default:e.currentView="live"}}},components:{}}).$mount("#artist");