"use strict";Vue.component("mVideo",{template:"#m_video",data:function(){return{isVideoLoad:!1}},mounted:function(){},props:{poster:{type:String,default:""},url:{type:String,default:""},id:{type:String,default:""}},methods:{loadVideo:function(){var t=this;t.isVideoLoad=!0,t.$nextTick(function(){document.getElementById(t.id).play()})}}}),Vue.component("overview",{template:"#overview",mounted:function(){},computed:{calstock:function(){var t=this,e="无货";return t.product.stockCount>0&&(e="有货"),e}},data:function(){return{product:config.product}},methods:{}}),Vue.component("artist",{template:"#artist",mounted:function(){this.loadart()},data:function(){return{artist:[],artistsingle:{},titleshow:!1,chosen:!1,art_num:0,listloading:!1}},methods:{getBefore:function(){this.listloading=!0},loadsingle:function(t){var e=this;e.art_num=t,e.artistsingle=e.artist[t]},loadart:function(){var t=this;tools.ajaxGet(config.artist_url,t.getSucc,t.getBefore)},getSucc:function(t){var e=this;e.artist=t.data,e.titleshow=e.artist.length>1,e.loadsingle(0),e.listloading=!1}}}),Vue.component("pug",{template:"#pug",mounted:function(){this.loadpug()},data:function(){return{pugs:[],pugsingle:{},titleshow:!1,chosen:!1,pug_num:0,listloading:!1}},methods:{getBefore:function(){this.listloading=!0},loadsingle:function(t){var e=this;e.pug_num=t,e.pugsingle=e.pugs[t]},loadpug:function(){var t=this;tools.ajaxGet(config.pug_url,t.pugSucc,t.getBefore)},pugSucc:function(t){var e=this;e.pugs=t.data,e.titleshow=e.pugs.length>1,e.loadsingle(0),e.listloading=!1}}}),Vue.component("service",{template:"#service",mounted:function(){},data:function(){return{tab_service:config.tab_service}}}),Vue.component("discuss",{template:"#discuss",mounted:function(){this.loadList()},data:function(){return{pager:{},commentlist:[],preventRepeatReuqest:!1,last_url:"",listloading:!1}},directives:{"load-more":{bind:function(t,e){var o=window.screen.height,n=void 0,i=void 0,s=void 0,c=void 0,a=void 0,u=void 0,r=void 0,l=void 0,d=t.attributes.type&&t.attributes.type.value;2==d?(r=t,l=t.children[0]):(r=document.body,l=t),t.addEventListener("touchstart",function(){n=l.clientHeight,2==d&&(n=n),i=t.offsetTop,s=tools.getStyle(t,"paddingBottom"),c=tools.getStyle(t,"marginBottom")},!1),t.addEventListener("touchmove",function(){g()},!1),t.addEventListener("touchend",function(){u=r.scrollTop,p()},!1);var p=function t(){a=requestAnimationFrame(function(){r.scrollTop!=u?(u=r.scrollTop,t()):(cancelAnimationFrame(a),n=l.clientHeight,g())})},g=function(){r.scrollTop+o>=n+i+s+c-2&&e.value()}}}},methods:{getBefore:function(){this.listloading=!0},c_star:function(t){return 5-t},nextPage:function(){var t=this;if(t.preventRepeatReuqest=!0,t.pager.next>0){var e=config.discuss_url+"?page="+t.pager.next;e!==t.last_url&&(t.last_url=e,tools.ajaxGet(e,t.pageSucc,t.getBefore))}},pageSucc:function(t){var e=this;e.commentlist=t.data.entries.concat(e.commentlist),e.pager=t.data.pager,e.preventRepeatReuqest=!1,e.listloading=!1},loadList:function(){var t=this;tools.ajaxGet(config.discuss_url,t.listSucc,t.getBefore)},listSucc:function(t){var e=this;e.commentlist=t.data.entries,e.pager=t.data.pager,e.listloading=!1}}});var app=new Vue({data:{product:config.product,ranks_list:[],pro_list:[],loading:!1,refreshing:!1,img_url:"public/images",currentView:"overview",tabs:["概览","艺人","泥料","售后保障","评论"],tab_num:0,showAlert:!1,msg:null,open:!1,docked:!1,chosen:!1,input_val:1,specs_single:[],specs_num:0,min:!1,max:!1,collected:config.product.favoriteState,numsshow:!1,isbuy:!1,cart_num:config.product.cartProductCount,subText:"加入购物车"},mounted:function(){var t=this;t.loadcart(),t.specs_single=t.product.specification[0]},computed:{calstock:function(){var t=this,e=0;return t.product.specification.length<=0?t.product.stockCount>0&&(e="有货"):t.specs_single.stockCount>0&&(e="有货"),e},showprice:function(){var t=this;return t.product.specification.length<=0?t.product.hasDiscount&&(t.product.discount.hasBegin||t.product.discount.canBuy)?t.product.promotionPrice:t.product.salePrice:t.product.hasDiscount&&(t.product.discount.hasBegin||t.product.discount.canBuy)?t.specs_single.promotionPrice:t.specs_single.salePrice}},methods:{loadcart:function(){var t=this,e=t.cart_num;t.numsshow=e>0},top:function(){tools.animate(document.body,{scrollTop:"0"},400,"ease-out")},collection:function(){var t=this;jAjax({type:"post",url:config.fav_url,timeOut:5e3,before:function(){},success:function(e){e&&(e=JSON.parse(e),200==parseInt(e.code)&&(t.collected=e.data.favoriteState,t.collected,t.showAlert=!0,t.msg=e.message,t.close_auto()))},error:function(){}})},change:function(t){},add:function(){var t=this,e=parseInt(t.input_val.toString().replace(/[^\d]/g,"")),o=0;o=t.product.specification.length<=0?t.product.stockCount:t.specs_single.stockCount,t.min&&(t.min=!1),e<o&&(e+=1)===o&&(t.max=!0),t.input_val=e},minus:function(){var t=this,e=parseInt(t.input_val.toString().replace(/[^\d]/g,""));t.max&&(t.max=!1),e>0&&(e-=1,0===e&&(t.min=!0),t.input_val=e)},footLinkTo:function(t){var e=this;e.specs_num=t,e.specs_single=e.product.specification[t],e.input_val=1,e.min=!1,e.max=!1},prevent:function(t){t.preventDefault(),t.stopPropagation()},choose:function(){var t=this;t.open?(t.open=!1,setTimeout(function(){t.docked=!1},300)):(t.docked=!0,t.open=!0)},chooseSpec:function(){var t=this;t.chosen?t.chosen=!1:t.chosen=!0},buy:function(t){var e=this;if(1==parseInt(t)){var o=config.buy_url+"?product_id="+e.product.id;e.specs_single&&e.specs_single.id&&(o+="&spec_id="+e.specs_single.id),o+="&buy_number="+e.input_val,location.href=o}else{var n=config.addcart_url,i=formData.serializeForm("addcart");e.$refs.subpost.post(n,i)}},linkTo:function(t){var e=this;switch(e.tab_num=t,parseInt(t)){case 0:e.currentView="overview";break;case 1:e.currentView="artist";break;case 2:e.currentView="pug";break;case 3:e.currentView="service";break;case 4:e.currentView="discuss";break;default:e.currentView="overview"}},succhandle:function(t){var e=this;e.cart_num=t.data.cartProductCount,e.loadcart(),e.msg=t.message,e.showAlert=!0,t.url?e.close_auto(e.linkto,t.url):e.close_auto()},close:function(){this.showAlert=!1},close_auto:function(t,e){var o=this;setTimeout(function(){o.showAlert=!1,t&&t(e)},1500)},linkto:function(t){t&&(location.href=t)}},components:{}}).$mount("#detail");