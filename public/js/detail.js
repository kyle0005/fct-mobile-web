"use strict";Vue.component("overview",{template:"#overview",mounted:function(){var t=this;t.loadoverview(),t.loadVideo()},computed:{calstock:function(){var t=this,o="无货";return t.product.stockCount>0&&(o="有货"),o}},data:function(){return{product:{}}},methods:{loadVideo:function(){var t=this,o={fluid:!0,aspectRatio:"2:1",preload:"auto",poster:t.product.video.poster};videojs("my-player",o,function(){this.src(t.product.video.url),videojs.log("Your player is ready!"),this.play(),this.on("ended",function(){videojs.log("Awww...over so soon?!")})})},loadoverview:function(){this.product=config.product}}}),Vue.component("artist",{template:"#artist",mounted:function(){this.loadart()},data:function(){return{artist:[],artistsingle:{},titleshow:!1,chosen:!1,art_num:0}},methods:{loadsingle:function(t){var o=this;o.art_num=t,o.artistsingle=o.artist[t]},loadart:function(){var t=this;jAjax({type:"get",url:config.artist_url,timeOut:5e3,before:function(){console.log("before")},success:function(o){o&&(o=JSON.parse(o),200==parseInt(o.code)&&(t.artist=o.data,t.titleshow=t.artist.length>1,t.loadsingle(0)))},error:function(){console.log("error")}})}}}),Vue.component("pug",{template:"#pug",mounted:function(){this.loadpug()},data:function(){return{pugs:[],pugsingle:{},titleshow:!1,chosen:!1,pug_num:0}},methods:{loadsingle:function(t){var o=this;o.pug_num=t,o.pugsingle=o.pugs[t]},loadpug:function(){var t=this;jAjax({type:"get",url:config.pug_url,timeOut:5e3,before:function(){console.log("before")},success:function(o){o&&(o=JSON.parse(o),200==parseInt(o.code)&&(t.pugs=o.data,t.titleshow=t.pugs.length>1,t.loadsingle(0)))},error:function(){console.log("error")}})}}}),Vue.component("service",{template:"#service",mounted:function(){},data:function(){return{tab_service:config.tab_service}}}),Vue.component("discuss",{template:"#discuss",mounted:function(){this.loadList()},data:function(){return{commentlist:[]}},methods:{c_star:function(t){return 5-t},loadList:function(){var t=this;jAjax({type:"get",url:config.discuss_url,timeOut:5e3,before:function(){console.log("before")},success:function(o){o&&(o=JSON.parse(o),200==parseInt(o.code)&&(t.commentlist=o.data))},error:function(){console.log("error")}})}}});var app=new Vue({data:{product:config.product,ranks_list:[],pro_list:[],loading:!1,refreshing:!1,img_url:"public/images",currentView:"overview",tabs:["概览","艺人","泥料","售后保障","评论"],tab_num:0,showAlert:!1,msg:null,open:!1,docked:!1,chosen:!1,input_val:1,specs_single:[],specs_num:0,min:!1,max:!1,collected:config.product.favoriteState,numsshow:!1,isbuy:!1,cart_num:config.product.cartProductCount,subText:"加入购物车"},mounted:function(){var t=this;t.loadcart(),t.specs_single=t.product.specification[0]},computed:{calstock:function(){var t=this,o=0;return t.product.specification.length<=0?t.product.stockCount>0&&(o="有货"):t.specs_single.stockCount>0&&(o="有货"),o},showprice:function(){var t=this;return t.product.specification.length<=0?t.product.hasDiscount&&(t.product.discount.hasBegin||t.product.discount.canBuy)?t.product.promotionPrice:t.product.salePrice:t.product.hasDiscount&&(t.product.discount.hasBegin||t.product.discount.canBuy)?t.specs_single.promotionPrice:t.specs_single.salePrice}},methods:{loadcart:function(){var t=this,o=t.cart_num;t.numsshow=o>0},top:function(){tools.animate(document.body,{scrollTop:"0"},400,"ease-out")},collection:function(){var t=this;jAjax({type:"post",url:config.fav_url,timeOut:5e3,before:function(){},success:function(o){o&&(o=JSON.parse(o),200==parseInt(o.code)&&(t.collected=o.data.favoriteState,t.collected,t.showAlert=!0,t.msg=o.message,t.close_auto()))},error:function(){}})},change:function(t){},add:function(){var t=this,o=parseInt(t.input_val.toString().replace(/[^\d]/g,"")),e=0;e=t.product.specification.length<=0?t.product.stockCount:t.specs_single.stockCount,t.min&&(t.min=!1),o<e&&(o+=1)===e&&(t.max=!0),t.input_val=o},minus:function(){var t=this,o=parseInt(t.input_val.toString().replace(/[^\d]/g,""));t.max&&(t.max=!1),o>0&&(o-=1,0===o&&(t.min=!0),t.input_val=o)},footLinkTo:function(t){var o=this;o.specs_num=t,o.specs_single=o.product.specification[t],o.input_val=1,o.min=!1,o.max=!1},prevent:function(t){t.preventDefault(),t.stopPropagation()},choose:function(){var t=this;t.open?(t.open=!1,setTimeout(function(){t.docked=!1},300)):(t.docked=!0,t.open=!0)},chooseSpec:function(){var t=this;t.chosen?t.chosen=!1:t.chosen=!0},buy:function(t){var o=this;if(1==parseInt(t)){var e=config.buy_url+"?product_id="+o.product.id;o.specs_single&&o.specs_single.id&&(e+="&spec_id="+o.specs_single.id),e+="&buy_number="+o.input_val,location.href=e}else{var n=config.addcart_url,i=formData.serializeForm("addcart");o.$refs.subpost.post(n,i)}},linkTo:function(t){var o=this;switch(o.tab_num=t,parseInt(t)){case 0:o.currentView="overview";break;case 1:o.currentView="artist";break;case 2:o.currentView="pug";break;case 3:o.currentView="service";break;case 4:o.currentView="discuss";break;default:o.currentView="overview"}},succhandle:function(t){var o=this;o.cart_num=t.data.cartProductCount,o.loadcart(),o.msg=t.message,o.showAlert=!0,t.url?o.close_auto(o.linkto,t.url):o.close_auto()},close:function(){this.showAlert=!1},close_auto:function(t,o){var e=this;setTimeout(function(){e.showAlert=!1,t&&t(o)},1500)},linkto:function(t){t&&(location.href=t)}},components:{}}).$mount("#detail");